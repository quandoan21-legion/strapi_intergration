"use strict";(self.webpackChunktech_events_strapi=self.webpackChunktech_events_strapi||[]).push([[5447],{20667(N,A,s){s.d(A,{M:()=>U,S:()=>t,a:()=>h});var a=s(92132),e=s(54894),l=s(82688),m=s(88353),i=s(56654),P=s(55506),C=s(90625),I=s(84795),c=s(47610),D=s(88141);const h=({children:r,target:_})=>{const O=(0,P.hN)(),{formatMessage:g}=(0,e.A)(),{copy:v}=(0,P.iD)(),d=g({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),n=async()=>{await v(_)&&O({type:"info",message:{id:"notification.link-copied"}})};return(0,a.jsx)(P.bQ,{endAction:(0,a.jsx)(m.K,{label:d,noBorder:!0,icon:(0,a.jsx)(C.A,{}),onClick:n}),title:_,titleEllipsis:!0,subtitle:r,icon:(0,a.jsx)("span",{style:{fontSize:32},children:"\u2709\uFE0F"}),iconBackground:"neutral100"})},U=({registrationToken:r})=>{const{formatMessage:_}=(0,e.A)(),O=`${window.location.origin}${(0,l.K)()}/auth/register?registrationToken=${r}`;return(0,a.jsx)(h,{target:O,children:_({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})})},t=({disabled:r,error:_,onChange:O,value:g})=>{const{isLoading:v,roles:d}=(0,D.u)(),{formatMessage:n}=(0,e.A)(),T=_?n({id:_,defaultMessage:_}):"",Y=n({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),H=n({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),Z=n({id:"app.components.Select.placeholder",defaultMessage:"Select"});return(0,a.jsx)(i.KF,{id:"roles",disabled:r,error:T,hint:H,label:Y,name:"roles",onChange:E=>{O({target:{name:"roles",value:E}})},placeholder:Z,startIcon:v?(0,a.jsx)(W,{}):void 0,value:g.map(E=>E.toString()),withTags:!0,required:!0,children:d.map(E=>(0,a.jsx)(i.fe,{value:E.id.toString(),children:n({id:`global.${E.code}`,defaultMessage:E.name})},E.id))})},p=(0,c.i7)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,R=c.Ay.div`
  animation: ${p} 2s infinite linear;
`,W=()=>(0,a.jsx)(R,{children:(0,a.jsx)(I.A,{})})},25447(N,A,s){s.d(A,{ProtectedEditPage:()=>ts});var a=s(92132),e=s(21272),l=s(94061),m=s(85963),i=s(90151),P=s(68074),C=s(4198),I=s(55356),c=s(38413),D=s(83997),h=s(30893),U=s(21610),t=s(55506),p=s(46270),R=s(54514),W=s(61535),r=s(79275),_=s(54894),O=s(71389),g=s(17703),v=s(12083),d=s(82688),n=s(70500),T=s(20667),Y=s(97146),H=s(15126),Z=s(63299),E=s(67014),ds=s(59080),ls=s(14718),Es=s(82437),Ms=s(5790),ms=s(35223),Ps=s(5409),cs=s(74930),Ds=s(2600),Os=s(48940),gs=s(41286),As=s(56336),hs=s(13426),vs=s(84624),Ls=s(77965),fs=s(54257),Cs=s(71210),Is=s(51187),Us=s(39404),ps=s(58692),us=s(501),Bs=s(57646),Rs=s(23120),Ws=s(44414),Ts=s(25962),Ks=s(14664),xs=s(42588),js=s(90325),ys=s(62785),Ss=s(87443),zs=s(41032),Ns=s(22957),Ys=s(93179),Fs=s(73055),Qs=s(15747),Vs=s(85306),$s=s(26509),Js=s(32058),Xs=s(81185),Gs=s(82261),Hs=s(55151),Zs=s(79077),bs=s(88141);const q=v.Ik().shape({...Y.C,isActive:v.lc(),roles:v.YO().min(1,t.iW.required).required(t.iW.required)}),b=["email","firstname","lastname","username","isActive","roles"],ss=()=>{const{formatMessage:o}=(0,_.A)(),u=(0,g.W5)("/settings/users/:id")?.params?.id??"",{push:B}=(0,g.W6)(),M=(0,t.hN)(),{lockApp:Q,unlockApp:V}=(0,t.MA)(),w=(0,d.p)(T.M,async()=>(await s.e(5297).then(s.bind(s,5297))).MagicLinkEE),{_unstableFormatAPIError:$,_unstableFormatValidationErrors:es}=(0,t.wq)(),k=(0,d.j)(n.s),{isLoading:os,allowedActions:{canUpdate:J}}=(0,t.ec)({read:k.settings?.users.read??[],update:k.settings?.users.update??[]}),[ns]=(0,d.M)();(0,t.L4)();const{data:is,error:y,isLoading:rs}=(0,d.k)({id:u},{refetchOnMountOrArgChange:!0}),[S]=is?.users??[];if(e.useEffect(()=>{y&&(y.name==="UnauthorizedError"?(M({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),B("/")):M({type:"warning",message:{id:"notification.error",defaultMessage:$(y)}}))},[y,$,B,M]),rs||!w||os)return(0,a.jsxs)(c.g,{"aria-busy":"true",children:[(0,a.jsx)(t.x7,{name:"Users"}),(0,a.jsx)(I.Q,{primaryAction:(0,a.jsx)(m.$,{disabled:!0,startIcon:(0,a.jsx)(R.A,{}),type:"button",size:"L",children:o({id:"global.save",defaultMessage:"Save"})}),title:o({id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}),navigationAction:(0,a.jsx)(U.N,{as:O.k2,startIcon:(0,a.jsx)(p.A,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:o({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsx)(C.s,{children:(0,a.jsx)(t.Bl,{})})]});const z={...r(S,b),roles:S.roles.map(({id:L})=>L),password:"",confirmPassword:""},_s=async(L,K)=>{Q?.();const{confirmPassword:X,password:x,...G}=L,f=await ns({id:u,...G,password:x===""?void 0:x});"error"in f&&(0,d.x)(f.error)?(f.error.name==="ValidationError"&&K.setErrors(es(f.error)),M({type:"warning",message:$(f.error)})):(M({type:"success",message:o({id:"notification.success.saved",defaultMessage:"Saved"})}),K.setValues({...r(L,b),password:"",confirmPassword:""})),V?.()};return(0,a.jsxs)(c.g,{children:[(0,a.jsx)(t.x7,{name:"Users"}),(0,a.jsx)(W.l1,{onSubmit:_s,initialValues:z,validateOnChange:!1,validationSchema:q,children:({errors:L,values:K,handleChange:X,isSubmitting:x,dirty:G})=>(0,a.jsxs)(t.lV,{children:[(0,a.jsx)(I.Q,{primaryAction:(0,a.jsx)(m.$,{disabled:x||!J?!0:!G,startIcon:(0,a.jsx)(R.A,{}),loading:x,type:"submit",size:"L",children:o({id:"global.save",defaultMessage:"Save"})}),title:o({id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},{name:z.username||(0,n.g)(z?.firstname??"",z.lastname)}),navigationAction:(0,a.jsx)(U.N,{as:O.k2,startIcon:(0,a.jsx)(p.A,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:o({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsxs)(C.s,{children:[S?.registrationToken&&(0,a.jsx)(l.a,{paddingBottom:6,children:(0,a.jsx)(w,{registrationToken:S.registrationToken})}),(0,a.jsxs)(D.s,{direction:"column",alignItems:"stretch",gap:7,children:[(0,a.jsx)(l.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(D.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(h.o,{variant:"delta",as:"h2",children:o({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})}),(0,a.jsx)(i.x,{gap:5,children:as.map(f=>f.map(j=>(0,a.jsx)(P.E,{...j.size,children:(0,a.jsx)(t.ah,{...j,disabled:!J,error:L[j.name],onChange:X,value:K[j.name]})},j.name)))})]})}),(0,a.jsx)(l.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(D.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(h.o,{variant:"delta",as:"h2",children:o({id:"global.roles",defaultMessage:"User's role"})}),(0,a.jsx)(i.x,{gap:5,children:(0,a.jsx)(P.E,{col:6,xs:12,children:(0,a.jsx)(T.S,{disabled:!J,error:L.roles,onChange:X,value:K.roles})})})]})})]})]})]})})]})},as=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]],ts=()=>{const o=(0,t.hN)(),F=(0,d.j)(n.s),{isLoading:u,allowedActions:{canRead:B,canUpdate:M}}=(0,t.ec)({read:F.settings?.users.read??[],update:F.settings?.users.update??[]}),{state:Q}=(0,g.zy)(),V=Q?.from??"/";return e.useEffect(()=>{u||!B&&!M&&o({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[u,B,M,o]),u?(0,a.jsx)(t.Bl,{}):!B&&!M?(0,a.jsx)(g.rd,{to:V}):(0,a.jsx)(ss,{})}},88141(N,A,s){s.d(A,{u:()=>i});var a=s(21272),e=s(55506),l=s(54894),m=s(82688);const i=(P={},C)=>{const{locale:I}=(0,l.A)(),c=(0,e.QM)(I,{sensitivity:"base"}),{data:D,error:h,isError:U,isLoading:t,refetch:p}=(0,m.z)(P,C);return{roles:a.useMemo(()=>[...D??[]].sort((W,r)=>c.compare(W.name,r.name)),[D,c]),error:h,isError:U,isLoading:t,refetch:p}}},97146(N,A,s){s.d(A,{C:()=>l});var a=s(55506),e=s(12083);const l={firstname:e.Yj().trim().required(a.iW.required),lastname:e.Yj(),email:e.Yj().email(a.iW.email).lowercase().required(a.iW.required),username:e.Yj().nullable(),password:e.Yj().min(8,a.iW.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Yj().min(8,a.iW.minLength).oneOf([e.KR("password"),null],"components.Input.error.password.noMatch").when("password",(m,i)=>m?i.required(a.iW.required):i)}}}]);
